\documentclass[
hidelinks,
12pt, % The default document font size, options: 10pt, 11pt, 12pt
oneside, % Two side (alternating margins) for binding by default, uncomment to switch to one side
english, % ngerman for German
doublespacing, % Single line spacing, alternatives: onehalfspacing or singlespacing
%draft, % Uncomment to enable draft mode (no pictures, no links, overfull hboxes indicated)
%nolistspacing, % If the document is onehalfspacing or doublespacing, uncomment this to set spacing in lists to single
%liststotoc, % Uncomment to add the list of figures/tables/etc to the table of contents
%toctotoc, % Uncomment to add the main table of contents to the table of contents
%parskip, % Uncomment to add space between paragraphs
%nohyperref, % Uncomment to not load the hyperref package
headsepline, % Uncomment to get a line under the header
chapterinoneline, % Uncomment to place the chapter title next to the number on one line
%consistentlayout, % Uncomment to change the layout of the declaration, abstract and acknowledgements pages to match the default layout
]{MastersDoctoralThesis} % The class file specifying the document structure

\usepackage[utf8]{inputenc} % Required for inputting international characters
\usepackage[T1]{fontenc} % Output font encoding for international characters
\usepackage{subcaption}
\usepackage[belowskip=-15pt,aboveskip=0pt]{caption}
\setlength{\textfloatsep}{10pt plus 2.0pt minus 2.0pt}
\setlength{\intextsep}{10pt plus 2pt minus 2pt}
\setlength{\floatsep}{10pt plus 2.0pt minus 2.0pt}
\usepackage{mathpazo} % Use the Palatino font by default
\usepackage{booktabs}
\usepackage{colortbl}
\usepackage[ruled,vlined,linesnumbered,algochapter]{algorithm2e}
\usepackage[final]{pdfpages}
\usepackage{xcolor}
\usepackage{balance}
\usepackage{epigraph}
\usepackage{alltt} % for code snippet
\usepackage{listings}
\usepackage{hyperref}
\usepackage{amsmath,amsthm}
\usepackage{macros}
\usepackage{mathtools}
\usepackage{optidef}
\usepackage{float}
\usepackage{newtxmath}
\usepackage{polski}
\usepackage{tikz-cd}
\usepackage{flowchart}
\usepackage{tabularx}
\usepackage{enumitem}
% % Reduce spacing in toc
% \usepackage[titles]{tocloft}
% \setlength{\cftbeforechapskip}{5pt}
% Reduce spacing around section headers
\usepackage{titlesec}
\titlespacing*{\section}{0pt}{0pt}{5pt}
\titlespacing*{\subsection}{0pt}{2pt}{4pt}
\counterwithout{footnote}{chapter}
\usetikzlibrary{
  shapes,
  arrows.meta, % supersedes arrows
  calc,automata,positioning,fit,quotes}
  \tikzset{
  line/.style={draw, -Latex}
}
\tikzstyle{arrow} = [thick,->,>=stealth]
% \usepackage[square,numbers]{natbib}
% \bibliographystyle{abbrvnat}
\usepackage[backend=bibtex,style=numeric-comp,natbib=true,sortcites=true]{biblatex}
\usepackage[backend=bibtex,style=authoryear,natbib=true,backref=true]{biblatex} % use this line instead of the previous one if you want to use back references

\addbibresource{biblio.bib} % The filename of the bibliography


\usepackage[autostyle=true]{csquotes} % Required to generate language-dependent quotes in the bibliography

%----------------------------------------------------------------------------------------
%	MARGIN SETTINGS
%----------------------------------------------------------------------------------------

\geometry{
	paper=a4paper, % Change to letterpaper for US letter
	inner=4cm, % Inner margin
	outer=2.5cm, % Outer margin
	bindingoffset=.5cm, % Binding offset
	top=2.5cm, % Top margin
	bottom=2.5cm, % Bottom margin
    head=23.99748pt,
	%showframe, % Uncomment to show how the type block is set on the page
}

%----------------------------------------------------------------------------------------
%	THESIS INFORMATION
%----------------------------------------------------------------------------------------

\thesistitle{Manifold Structure of Artificial and Biological Neural Networks} % Your thesis title, this is used in the title and abstract, print it elsewhere with \ttitle
\supervisor{Dr/Pr. FirstName \textsc{LastName}} % Your supervisor's name, this is used in the title page, print it elsewhere with \supname
\examiner{Dr/Pr. FirstName \textsc{LastName}} % Your examiner's name, this is not currently used anywhere in the template, print it elsewhere with \examname
\degree{B.Sc (Hons)} % Your degree name, this is used in the title page and abstract, print it elsewhere with \degreename
\author{\textsc{Zhang} Liu} % Your name, this is used in the title page and abstract, print it elsewhere with \authorname
\addresses{} % Your address, this is not currently used anywhere in the template, print it elsewhere with \addressname

\subject{Mathematical, Computational and Statistical Sciences} % Your subject area, this is not currently used anywhere in the template, print it elsewhere with \subjectname
\keywords{manifold learning, neural computation, early primate vision, computer vision} % Keywords for your thesis, this is not currently used anywhere in the template, print it elsewhere with \keywordnames
\university{\href{https://www.yale-nus.edu.sg/}{Yale-NUS College}} % Your university's name and URL, this is used in the title page and abstract, print it elsewhere with \univname
\department{{}} % Your department's name and URL, this is used in the title page and abstract, print it elsewhere with \deptname
\group{{}} % Your research group's name and URL, this is used in the title page, print it elsewhere with \groupname
\faculty{{}} % Your faculty's name and URL, this is used in the title page and abstract, print it elsewhere with \facname

\AtBeginDocument{
%\hypersetup{colorlinks=false}
\hypersetup{pdftitle=\ttitle} % Set the PDF's title to your title
\hypersetup{pdfauthor=\authorname} % Set the PDF's author to your name
\hypersetup{pdfkeywords=\keywordnames} % Set the PDF's keywords to your keywords
\hypersetup{hypertexnames=true}

\setlength\abovedisplayskip{0pt}
\setlength\belowdisplayskip{0pt}
}


%%% TODO NOTES 
\usepackage{todonotes}
\def\frs#1{\todo[color=green!30]{\textbf{FS}:#1}}
\def\frsi#1{\todo[color=green!30,inline]{\textbf{FS}:#1}}

\begin{document}

\frontmatter

\pagestyle{plain} 

\begin{titlepage}
\includepdf[noautoscale=true]{capstone_titlepage.pdf}
\end{titlepage}

% \begin{abstract}
% \addchaptertocentry{\abstractname}
% \newpage 
% \centerline{\Huge Abstract}
\chapter{Abstract}
\textbf{Keywords: \keywordnames}

Our work builds on a long line of research aiming to develop more accurate computational models of the visual system. Despite decades of research, we have not fully understood the structure of neural circuits responsible for visual perception \cite{Gwilliams221630}. Additionally, among the computer vision (CV) community, there is a growing interest in investigating the limitations of the CV models by comparing them against biological vision. To this end, we seek to answer two specific open questions: First, how do CV models (VGG16 \cite{vgg16_simonyan_very_2015}, Vision Transformer \cite{vit_dosovitskiy_image_2021}, and Convolutional Recurrent Neural Network \cite{convrnn_shi_end--end_2015}) compare to biological vision, at retina and primary visual cortex (V1), in terms of their respective neural circuits\footnote{A neural circuit is a population of neurons interconnected by synapses to carry out a specific function when activated \cite{gerhard_neuroscience_2013}.}? Second, what specific mechanisms are important in causing such differences and/or similarities?

We first build the biological neural tensors using experimental neural spiking data and artificial neural tensors using numerical simulations on computer vision models (VGG16 \cite{vgg16_simonyan_very_2015}, Vision Transformer \cite{vit_dosovitskiy_image_2021}, and Convolutional Recurrent Neural Network \cite{convrnn_shi_end--end_2015}).
Using tensor CP decomposition, we obtain a manifold of neurons. The discrete data graph underlying the manifold then reflects both the neural circuit connections and the neurons' role in those circuits. By comparing the manifold structure of neurobiological networks in retina and V1 with that of computer vision models, we can make precise inferences about similarities and differences in their respective functional circuits. For the first time, we find that the underlying neural circuit of feed-forward computer vision models including CNN and ViT form disconnected network clusters, making them poor approximations of the visual cortex, contrary to popular belief. In order to model the highly connected neural circuits in the visual cortex, recurrent structure is likely necessary.

% \end{abstract}

% Since these groups are likely not independent, we use the non-linear dimensionality reduction method, diffusion maps, to infer a manifold of neurons.
% (represented by the discrete data graph underlying the continuous manifold) 
% groups  respond similarly to which stimuli input
%----------------------------------------------------------------------------------------
% CONTRIBUTIONS
%----------------------------------------------------------------------------------------

%https://ijast.org/credit-author-statement/

% In addition, code for displaying results in real-time, modules for managing servo overload, network latency and other factors were also written by the author.

% Reduce spacing in TOC

\begin{onehalfspacing}
\setcounter{tocdepth}{0}
\tableofcontents 
\end{onehalfspacing}



\mainmatter 
\pagestyle{thesis}

\input{chapters/chapter-intro}
\input{chapters/chapter-neuro}
\input{chapters/chapter-linear}
\input{chapters/chapter-biological}
\input{chapters/chapter-artificial}
\input{chapters/chapter-conclusion}

\appendix 


\renewcommand*{\bibfont}{\footnotesize}
\setlength\bibitemsep{0pt}
\begin{singlespacing}% \printbibliography[heading=bibintoc]
% \bibliography{biblio}[title=Bibliography (Main)]
\printbibliography[title=Bibliography (Main), heading=bibintoc, keyword=main]
\printbibliography[title=Bibliography (Supplementary), heading=bibintoc, notkeyword=main]
\end{singlespacing}


\input{appendix/appendix-quote}
\includepdf[pages=-,pagecommand={},width=\textwidth]{declaration.pdf}
\begin{acknowledgements}
\addchaptertocentry{\acknowledgementname} 
    I would like to thank my supervisor Francesca Spagnuolo  and co-supervisor and mentor Steven W.~Zucker and Luciano Dyballa for their generous guidance and advice. They have made possible the many serendipitous moments in this project. There have been ups and downs in this project, but their support has helped me keep a keen spirit for learning and discovery. To the faculty at Yale-NUS for nurturing me into a good human being, and for bearing with my countless weaknesses and mistakes, particularly the MCS faculty who have had paramount influence in my development as a researcher: Prof.~Francesca Spagnuolo, Prof.~Olivier Danvy, Prof.~David Smith, Prof.~Robby Tan, and  Prof.~Timothy Wertz. Remarkably, they somehow believed in me even in times when I myself did not and provided me with the right guidance. To my family, thank you for loving me for who I am. To my suitemates, friends, and alumni, thank you for patiently bearing with my endless sharing of my work and ideas. Specifically, I acknowledge Xiyao Fu, Aparna Gupte, Mark Yuen for providing feedback; almuni Abhinav Natarajan, Dion Ho, Sultan Aitzhan, Yiming Ng, Wei Han, Xin Run for supporting me throughout my college years; friends whom I have had conversations with about this capstone: Amanda Leong, Zhala Sarmast, Amberly Yeo, Glenda Chin, Dasha Haryfullina, Aiman Imtiaz, Lize Cai, Yanhua Wang, Linda Li, Jia Tang, Eric Lan, \dots To the trees on campus, thank you for being there and reminding me of the life force within me. To whoever has read thus far, it's my pleasure to take you on this short tour with me. I have flaws, and my thesis has flaws - I sincerely invite more conversations about them. 
    %  
\end{acknowledgements}

\input{appendix/appendix-all-experiments}
\input{appendix/appendix-lists}
\input{appendix/appendix-diffmap}
\input{appendix/appendix-pca}
\input{appendix/appendix-face-results}
\input{appendix/appendix-tda}
\input{appendix/appendix-tda-results}
% \input{appendix/appendix-code}
\end{document}
